Loading original dataset...
Original dataset loaded: 683 training batches
Loading augmented dataset...
Augmented dataset loaded: 2065 training batches
Initializing PINN model...
2025-07-03 10:12 - function:_save_args - INFO - Args:
2025-07-03 10:12 - function:_save_args - CRITICAL - 	csv_file:/home/choi/PICL/data_processed/preprocessed_battery_health_dataset_all_points.csv
2025-07-03 10:12 - function:_save_args - CRITICAL - 	csv_file_augmented:/home/choi/PICL/data_augmentation/battery_phys_augmented.csv
2025-07-03 10:12 - function:_save_args - CRITICAL - 	batch_size:128
2025-07-03 10:12 - function:_save_args - CRITICAL - 	normalization_method:z-score
2025-07-03 10:12 - function:_save_args - CRITICAL - 	epochs:100
2025-07-03 10:12 - function:_save_args - CRITICAL - 	early_stop:30
2025-07-03 10:12 - function:_save_args - CRITICAL - 	lr:0.0005
2025-07-03 10:12 - function:_save_args - CRITICAL - 	lr_F:0.0005
2025-07-03 10:12 - function:_save_args - CRITICAL - 	save_folder:result_small_sample_05_06_07_18
2025-07-03 10:12 - function:_save_args - CRITICAL - 	alpha:1.0
2025-07-03 10:12 - function:_save_args - CRITICAL - 	beta:0.5
2025-07-03 10:12 - function:_save_args - CRITICAL - 	contrastive_weight:0.1
2025-07-03 10:12 - function:_save_args - CRITICAL - 	pinn_weight:1.0
2025-07-03 10:12 - function:_save_args - CRITICAL - 	temperature:0.1
2025-07-03 10:12 - function:_save_args - CRITICAL - 	log_dir:training_log.txt
2025-07-03 10:12 - function:_save_args - CRITICAL - 	F_layers_num:4
2025-07-03 10:12 - function:_save_args - CRITICAL - 	F_hidden_dim:128
2025-07-03 10:12 - function:_save_args - CRITICAL - 	warmup_lr:0.0001
2025-07-03 10:12 - function:_save_args - CRITICAL - 	final_lr:1e-05
2025-07-03 10:12 - function:_save_args - CRITICAL - 	warmup_epochs:50
2025-07-03 10:12 - function:_save_args - CRITICAL - 	momentum:0.999
2025-07-03 10:12 - function:_save_args - CRITICAL - 	projection_dim:128
2025-07-03 10:12 - function:_save_args - CRITICAL - 	queue_size:4096
2025-07-03 10:12 - function:_save_args - CRITICAL - 	seed:42
2025-07-03 10:12 - function:_save_args - CRITICAL - 	wandb_project:battery-picle
2025-07-03 10:12 - function:_save_args - CRITICAL - 	wandb_entity:None
2025-07-03 10:12 - function:_save_args - CRITICAL - 	wandb_run_name:None
Could not create model visualization for wandb
Setting up contrastive learning wrapper...
PINN model has 41986 trainable parameters
Full contrastive wrapper has 158594 trainable parameters
Starting training...
[Epoch 1/100] Current temperature: 0.2250
[Epoch 1] Total loss: 6294.8766 | PINN loss: 6294.7348 | Contrastive loss: 4.7281 | PDE loss: 0.0383 | Physics loss: 1.8331
[Validation] Epoch 1: MSE = 5948.195801
New best model saved at epoch 1 with validation MSE: 5948.195801
[Test] MSE: 5765.43359375, MAE: 75.605827, MAPE: 13.182614, RMSE: 75.930450, R²: -116.2733
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_1.png
[Epoch 2/100] Current temperature: 0.2239
[Epoch 2] Total loss: 5831.5270 | PINN loss: 5831.3865 | Contrastive loss: 4.6861 | PDE loss: 0.0078 | Physics loss: 1.1807
[Epoch 3/100] Current temperature: 0.2229
[Epoch 3] Total loss: 5565.6604 | PINN loss: 5565.5201 | Contrastive loss: 4.6753 | PDE loss: 0.0050 | Physics loss: 1.1290
[Epoch 4/100] Current temperature: 0.2218
[Epoch 4] Total loss: 5338.0032 | PINN loss: 5337.8631 | Contrastive loss: 4.6685 | PDE loss: 0.0039 | Physics loss: 1.1009
[Epoch 5/100] Current temperature: 0.2207
[Epoch 5] Total loss: 5151.3723 | PINN loss: 5151.2323 | Contrastive loss: 4.6659 | PDE loss: 0.0033 | Physics loss: 1.1057
[Epoch 6/100] Current temperature: 0.2196
[Epoch 6] Total loss: 4999.8667 | PINN loss: 4999.7268 | Contrastive loss: 4.6634 | PDE loss: 0.0029 | Physics loss: 1.1023
[Epoch 7/100] Current temperature: 0.2186
[Epoch 7] Total loss: 4888.3400 | PINN loss: 4888.2002 | Contrastive loss: 4.6604 | PDE loss: 0.0026 | Physics loss: 1.1052
[Epoch 8/100] Current temperature: 0.2175
[Epoch 8] Total loss: 4807.4873 | PINN loss: 4807.3475 | Contrastive loss: 4.6598 | PDE loss: 0.0025 | Physics loss: 1.1055
[Epoch 9/100] Current temperature: 0.2164
[Epoch 9] Total loss: 4756.6287 | PINN loss: 4756.4890 | Contrastive loss: 4.6567 | PDE loss: 0.0024 | Physics loss: 1.1007
[Epoch 10/100] Current temperature: 0.2154
[Epoch 10] Total loss: 4731.9868 | PINN loss: 4731.8471 | Contrastive loss: 4.6569 | PDE loss: 0.0023 | Physics loss: 1.0983
[Validation] Epoch 10: MSE = 4707.354004
New best model saved at epoch 10 with validation MSE: 4707.354004
[Test] MSE: 4543.57958984, MAE: 67.040245, MAPE: 4.686894, RMSE: 67.406082, R²: -91.4199
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_10.png
[Epoch 11/100] Current temperature: 0.2143
[Epoch 11] Total loss: 4602.2651 | PINN loss: 4602.1252 | Contrastive loss: 4.6640 | PDE loss: 0.0023 | Physics loss: 1.0692
[Epoch 12/100] Current temperature: 0.2132
[Epoch 12] Total loss: 4368.5589 | PINN loss: 4368.4189 | Contrastive loss: 4.6651 | PDE loss: 0.0021 | Physics loss: 1.0657
[Epoch 13/100] Current temperature: 0.2121
[Epoch 13] Total loss: 4148.6031 | PINN loss: 4148.4630 | Contrastive loss: 4.6686 | PDE loss: 0.0020 | Physics loss: 1.0434
[Epoch 14/100] Current temperature: 0.2111
[Epoch 14] Total loss: 3935.5750 | PINN loss: 3935.4349 | Contrastive loss: 4.6693 | PDE loss: 0.0019 | Physics loss: 1.0227
[Epoch 15/100] Current temperature: 0.2100
[Epoch 15] Total loss: 3734.4080 | PINN loss: 3734.2680 | Contrastive loss: 4.6674 | PDE loss: 0.0019 | Physics loss: 1.0156
[Epoch 16/100] Current temperature: 0.2089
[Epoch 16] Total loss: 3548.2585 | PINN loss: 3548.1186 | Contrastive loss: 4.6660 | PDE loss: 0.0018 | Physics loss: 0.9836
[Epoch 17/100] Current temperature: 0.2079
[Epoch 17] Total loss: 3379.9807 | PINN loss: 3379.8406 | Contrastive loss: 4.6690 | PDE loss: 0.0017 | Physics loss: 0.9641
[Epoch 18/100] Current temperature: 0.2068
[Epoch 18] Total loss: 3223.1229 | PINN loss: 3222.9828 | Contrastive loss: 4.6676 | PDE loss: 0.0017 | Physics loss: 0.9493
[Epoch 19/100] Current temperature: 0.2057
[Epoch 19] Total loss: 3083.8089 | PINN loss: 3083.6690 | Contrastive loss: 4.6657 | PDE loss: 0.0017 | Physics loss: 0.9206
[Epoch 20/100] Current temperature: 0.2046
[Epoch 20] Total loss: 2963.4546 | PINN loss: 2963.3146 | Contrastive loss: 4.6662 | PDE loss: 0.0017 | Physics loss: 0.9138
[Validation] Epoch 20: MSE = 2903.477539
New best model saved at epoch 20 with validation MSE: 2903.477539
[Test] MSE: 2772.39648438, MAE: 52.184418, MAPE: 1.789559, RMSE: 52.653553, R²: -55.3927
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_20.png
[Epoch 21/100] Current temperature: 0.2036
[Epoch 21] Total loss: 2856.8861 | PINN loss: 2856.7462 | Contrastive loss: 4.6656 | PDE loss: 0.0017 | Physics loss: 0.9023
[Epoch 22/100] Current temperature: 0.2025
[Epoch 22] Total loss: 2765.2255 | PINN loss: 2765.0855 | Contrastive loss: 4.6647 | PDE loss: 0.0017 | Physics loss: 0.8739
[Epoch 23/100] Current temperature: 0.2014
[Epoch 23] Total loss: 2687.2289 | PINN loss: 2687.0889 | Contrastive loss: 4.6668 | PDE loss: 0.0017 | Physics loss: 0.8763
[Epoch 24/100] Current temperature: 0.2004
[Epoch 24] Total loss: 2623.4279 | PINN loss: 2623.2880 | Contrastive loss: 4.6632 | PDE loss: 0.0016 | Physics loss: 0.8795
[Epoch 25/100] Current temperature: 0.1993
[Epoch 25] Total loss: 2572.8964 | PINN loss: 2572.7564 | Contrastive loss: 4.6665 | PDE loss: 0.0016 | Physics loss: 0.8714
[Epoch 26/100] Current temperature: 0.1982
[Epoch 26] Total loss: 2533.3569 | PINN loss: 2533.2170 | Contrastive loss: 4.6651 | PDE loss: 0.0016 | Physics loss: 0.8679
[Epoch 27/100] Current temperature: 0.1971
[Epoch 27] Total loss: 2501.4440 | PINN loss: 2501.3040 | Contrastive loss: 4.6654 | PDE loss: 0.0016 | Physics loss: 0.8544
[Epoch 28/100] Current temperature: 0.1961
[Epoch 28] Total loss: 2479.0509 | PINN loss: 2478.9109 | Contrastive loss: 4.6676 | PDE loss: 0.0016 | Physics loss: 0.8487
[Epoch 29/100] Current temperature: 0.1950
[Epoch 29] Total loss: 2460.4430 | PINN loss: 2460.3030 | Contrastive loss: 4.6672 | PDE loss: 0.0016 | Physics loss: 0.8492
[Epoch 30/100] Current temperature: 0.1939
[Epoch 30] Total loss: 2447.2629 | PINN loss: 2447.1228 | Contrastive loss: 4.6678 | PDE loss: 0.0016 | Physics loss: 0.8453
[Validation] Epoch 30: MSE = 2440.461914
New best model saved at epoch 30 with validation MSE: 2440.461914
[Test] MSE: 2319.36206055, MAE: 47.646389, MAPE: 1.413899, RMSE: 48.159756, R²: -46.1776
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_30.png
[Epoch 31/100] Current temperature: 0.1929
[Epoch 31] Total loss: 2355.9786 | PINN loss: 2355.8382 | Contrastive loss: 4.6797 | PDE loss: 0.0017 | Physics loss: 0.8413
[Epoch 32/100] Current temperature: 0.1918
[Epoch 32] Total loss: 2191.6145 | PINN loss: 2191.4739 | Contrastive loss: 4.6852 | PDE loss: 0.0017 | Physics loss: 0.8294
[Epoch 33/100] Current temperature: 0.1907
[Epoch 33] Total loss: 2034.8623 | PINN loss: 2034.7217 | Contrastive loss: 4.6872 | PDE loss: 0.0017 | Physics loss: 0.8284
[Epoch 34/100] Current temperature: 0.1896
[Epoch 34] Total loss: 1885.3278 | PINN loss: 1885.1871 | Contrastive loss: 4.6890 | PDE loss: 0.0016 | Physics loss: 0.8101
[Epoch 35/100] Current temperature: 0.1886
[Epoch 35] Total loss: 1740.6976 | PINN loss: 1740.5569 | Contrastive loss: 4.6901 | PDE loss: 0.0016 | Physics loss: 0.8078
[Epoch 36/100] Current temperature: 0.1875
[Epoch 36] Total loss: 1605.1536 | PINN loss: 1605.0128 | Contrastive loss: 4.6936 | PDE loss: 0.0016 | Physics loss: 0.8077
[Epoch 37/100] Current temperature: 0.1864
[Epoch 37] Total loss: 1474.7872 | PINN loss: 1474.6465 | Contrastive loss: 4.6919 | PDE loss: 0.0016 | Physics loss: 0.7988
[Epoch 38/100] Current temperature: 0.1854
[Epoch 38] Total loss: 1355.2573 | PINN loss: 1355.1165 | Contrastive loss: 4.6943 | PDE loss: 0.0017 | Physics loss: 0.8097
[Epoch 39/100] Current temperature: 0.1843
[Epoch 39] Total loss: 1243.0762 | PINN loss: 1242.9353 | Contrastive loss: 4.6949 | PDE loss: 0.0016 | Physics loss: 0.8067
[Epoch 40/100] Current temperature: 0.1832
[Epoch 40] Total loss: 1136.9447 | PINN loss: 1136.8039 | Contrastive loss: 4.6934 | PDE loss: 0.0016 | Physics loss: 0.8010
[Validation] Epoch 40: MSE = 1089.159302
New best model saved at epoch 40 with validation MSE: 1089.159302
[Test] MSE: 1004.87835693, MAE: 30.914291, MAPE: 0.613006, RMSE: 31.699816, R²: -19.4400
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_40.png
[Epoch 41/100] Current temperature: 0.1821
[Epoch 41] Total loss: 1039.1358 | PINN loss: 1038.9949 | Contrastive loss: 4.6955 | PDE loss: 0.0016 | Physics loss: 0.8085
[Epoch 42/100] Current temperature: 0.1811
[Epoch 42] Total loss: 948.7141 | PINN loss: 948.5731 | Contrastive loss: 4.6983 | PDE loss: 0.0016 | Physics loss: 0.8027
[Epoch 43/100] Current temperature: 0.1800
[Epoch 43] Total loss: 866.7983 | PINN loss: 866.6574 | Contrastive loss: 4.6972 | PDE loss: 0.0016 | Physics loss: 0.8091
[Epoch 44/100] Current temperature: 0.1789
[Epoch 44] Total loss: 789.8568 | PINN loss: 789.7157 | Contrastive loss: 4.7018 | PDE loss: 0.0016 | Physics loss: 0.8089
[Epoch 45/100] Current temperature: 0.1779
[Epoch 45] Total loss: 721.7773 | PINN loss: 721.6362 | Contrastive loss: 4.7036 | PDE loss: 0.0016 | Physics loss: 0.8099
[Epoch 46/100] Current temperature: 0.1768
[Epoch 46] Total loss: 656.8413 | PINN loss: 656.7001 | Contrastive loss: 4.7072 | PDE loss: 0.0016 | Physics loss: 0.8082
[Epoch 47/100] Current temperature: 0.1757
[Epoch 47] Total loss: 599.9552 | PINN loss: 599.8140 | Contrastive loss: 4.7068 | PDE loss: 0.0016 | Physics loss: 0.8046
[Epoch 48/100] Current temperature: 0.1746
[Epoch 48] Total loss: 547.5337 | PINN loss: 547.3924 | Contrastive loss: 4.7093 | PDE loss: 0.0016 | Physics loss: 0.8082
[Epoch 49/100] Current temperature: 0.1736
[Epoch 49] Total loss: 501.1624 | PINN loss: 501.0211 | Contrastive loss: 4.7113 | PDE loss: 0.0016 | Physics loss: 0.8125
[Epoch 50/100] Current temperature: 0.1725
[Epoch 50] Total loss: 458.2679 | PINN loss: 458.1265 | Contrastive loss: 4.7145 | PDE loss: 0.0016 | Physics loss: 0.8068
[Validation] Epoch 50: MSE = 441.027618
New best model saved at epoch 50 with validation MSE: 441.027618
[Test] MSE: 384.48205566, MAE: 18.311117, MAPE: 0.290499, RMSE: 19.608213, R²: -6.8207
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_50.png
[Epoch 51/100] Current temperature: 0.1714
[Epoch 51] Total loss: 421.4055 | PINN loss: 421.2641 | Contrastive loss: 4.7149 | PDE loss: 0.0016 | Physics loss: 0.7989
[Epoch 52/100] Current temperature: 0.1704
[Epoch 52] Total loss: 387.9199 | PINN loss: 387.7784 | Contrastive loss: 4.7177 | PDE loss: 0.0016 | Physics loss: 0.8051
[Epoch 53/100] Current temperature: 0.1693
[Epoch 53] Total loss: 359.4541 | PINN loss: 359.3125 | Contrastive loss: 4.7187 | PDE loss: 0.0015 | Physics loss: 0.8075
[Epoch 54/100] Current temperature: 0.1682
[Epoch 54] Total loss: 333.3100 | PINN loss: 333.1683 | Contrastive loss: 4.7216 | PDE loss: 0.0016 | Physics loss: 0.8065
[Epoch 55/100] Current temperature: 0.1671
[Epoch 55] Total loss: 310.9425 | PINN loss: 310.8009 | Contrastive loss: 4.7204 | PDE loss: 0.0016 | Physics loss: 0.8048
[Epoch 56/100] Current temperature: 0.1661
[Epoch 56] Total loss: 290.8713 | PINN loss: 290.7295 | Contrastive loss: 4.7254 | PDE loss: 0.0015 | Physics loss: 0.8059
[Epoch 57/100] Current temperature: 0.1650
[Epoch 57] Total loss: 273.0654 | PINN loss: 272.9236 | Contrastive loss: 4.7270 | PDE loss: 0.0015 | Physics loss: 0.8113
[Epoch 58/100] Current temperature: 0.1639
[Epoch 58] Total loss: 257.6595 | PINN loss: 257.5177 | Contrastive loss: 4.7289 | PDE loss: 0.0015 | Physics loss: 0.8124
[Epoch 59/100] Current temperature: 0.1629
[Epoch 59] Total loss: 244.9325 | PINN loss: 244.7906 | Contrastive loss: 4.7302 | PDE loss: 0.0015 | Physics loss: 0.8088
[Epoch 60/100] Current temperature: 0.1618
[Epoch 60] Total loss: 233.5608 | PINN loss: 233.4188 | Contrastive loss: 4.7321 | PDE loss: 0.0015 | Physics loss: 0.8072
[Validation] Epoch 60: MSE = 229.775940
New best model saved at epoch 60 with validation MSE: 229.775940
[Test] MSE: 187.63305664, MAE: 11.766395, MAPE: 0.169112, RMSE: 13.697922, R²: -2.8166
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_60.png
[Epoch 61/100] Current temperature: 0.1607
[Epoch 61] Total loss: 224.1944 | PINN loss: 224.0523 | Contrastive loss: 4.7359 | PDE loss: 0.0015 | Physics loss: 0.8077
[Epoch 62/100] Current temperature: 0.1596
[Epoch 62] Total loss: 215.5000 | PINN loss: 215.3578 | Contrastive loss: 4.7375 | PDE loss: 0.0015 | Physics loss: 0.8158
[Epoch 63/100] Current temperature: 0.1586
[Epoch 63] Total loss: 208.6592 | PINN loss: 208.5170 | Contrastive loss: 4.7396 | PDE loss: 0.0015 | Physics loss: 0.8042
[Epoch 64/100] Current temperature: 0.1575
[Epoch 64] Total loss: 202.2605 | PINN loss: 202.1182 | Contrastive loss: 4.7446 | PDE loss: 0.0015 | Physics loss: 0.8009
[Epoch 65/100] Current temperature: 0.1564
[Epoch 65] Total loss: 197.6808 | PINN loss: 197.5385 | Contrastive loss: 4.7443 | PDE loss: 0.0015 | Physics loss: 0.8090
[Epoch 66/100] Current temperature: 0.1554
[Epoch 66] Total loss: 193.0079 | PINN loss: 192.8655 | Contrastive loss: 4.7460 | PDE loss: 0.0015 | Physics loss: 0.8119
[Epoch 67/100] Current temperature: 0.1543
[Epoch 67] Total loss: 189.5686 | PINN loss: 189.4261 | Contrastive loss: 4.7492 | PDE loss: 0.0015 | Physics loss: 0.8067
[Epoch 68/100] Current temperature: 0.1532
[Epoch 68] Total loss: 185.8535 | PINN loss: 185.7110 | Contrastive loss: 4.7485 | PDE loss: 0.0015 | Physics loss: 0.8083
[Epoch 69/100] Current temperature: 0.1521
[Epoch 69] Total loss: 183.7347 | PINN loss: 183.5921 | Contrastive loss: 4.7513 | PDE loss: 0.0015 | Physics loss: 0.8067
[Epoch 70/100] Current temperature: 0.1511
[Epoch 70] Total loss: 180.4914 | PINN loss: 180.3488 | Contrastive loss: 4.7544 | PDE loss: 0.0015 | Physics loss: 0.8090
[Validation] Epoch 70: MSE = 180.308289
New best model saved at epoch 70 with validation MSE: 180.308289
[Test] MSE: 142.77014160, MAE: 9.844025, MAPE: 0.137352, RMSE: 11.948646, R²: -1.9041
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_70.png
[Epoch 71/100] Current temperature: 0.1500
[Epoch 71] Total loss: 161.6181 | PINN loss: 161.4752 | Contrastive loss: 4.7655 | PDE loss: 0.0017 | Physics loss: 0.8036
[Epoch 72/100] Current temperature: 0.1500
[Epoch 72] Total loss: 130.8834 | PINN loss: 130.7405 | Contrastive loss: 4.7647 | PDE loss: 0.0016 | Physics loss: 0.5231
[Epoch 73/100] Current temperature: 0.1500
[Epoch 73] Total loss: 104.3854 | PINN loss: 104.2429 | Contrastive loss: 4.7503 | PDE loss: 0.0018 | Physics loss: 0.1469
[Epoch 74/100] Current temperature: 0.1500
[Epoch 74] Total loss: 81.8141 | PINN loss: 81.6719 | Contrastive loss: 4.7418 | PDE loss: 0.0019 | Physics loss: 0.1380
[Epoch 75/100] Current temperature: 0.1500
[Epoch 75] Total loss: 60.7456 | PINN loss: 60.6034 | Contrastive loss: 4.7403 | PDE loss: 0.0022 | Physics loss: 0.1125
[Epoch 76/100] Current temperature: 0.1500
[Epoch 76] Total loss: 44.8222 | PINN loss: 44.6804 | Contrastive loss: 4.7294 | PDE loss: 0.0020 | Physics loss: 0.0873
[Epoch 77/100] Current temperature: 0.1500
[Epoch 77] Total loss: 32.4590 | PINN loss: 32.3173 | Contrastive loss: 4.7246 | PDE loss: 0.0020 | Physics loss: 0.0783
[Epoch 78/100] Current temperature: 0.1500
[Epoch 78] Total loss: 22.6365 | PINN loss: 22.4949 | Contrastive loss: 4.7213 | PDE loss: 0.0019 | Physics loss: 0.0720
[Epoch 79/100] Current temperature: 0.1500
[Epoch 79] Total loss: 15.5934 | PINN loss: 15.4519 | Contrastive loss: 4.7163 | PDE loss: 0.0019 | Physics loss: 0.0647
[Epoch 80/100] Current temperature: 0.1500
[Epoch 80] Total loss: 10.6941 | PINN loss: 10.5526 | Contrastive loss: 4.7157 | PDE loss: 0.0019 | Physics loss: 0.0576
[Validation] Epoch 80: MSE = 8.097183
New best model saved at epoch 80 with validation MSE: 8.097183
[Test] MSE: 2.22161245, MAE: 0.971487, MAPE: 0.011510, RMSE: 1.490507, R²: 0.9548
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_80.png
[Epoch 81/100] Current temperature: 0.1500
[Epoch 81] Total loss: 7.3332 | PINN loss: 7.1921 | Contrastive loss: 4.7129 | PDE loss: 0.0018 | Physics loss: 0.0492
[Epoch 82/100] Current temperature: 0.1500
[Epoch 82] Total loss: 5.1912 | PINN loss: 5.0577 | Contrastive loss: 4.7136 | PDE loss: 0.0019 | Physics loss: 0.0461
[Epoch 83/100] Current temperature: 0.1500
[Epoch 83] Total loss: 3.8652 | PINN loss: 3.7546 | Contrastive loss: 4.7110 | PDE loss: 0.0018 | Physics loss: 0.0433
[Epoch 84/100] Current temperature: 0.1500
[Epoch 84] Total loss: 3.0234 | PINN loss: 2.9355 | Contrastive loss: 4.7121 | PDE loss: 0.0018 | Physics loss: 0.0384
[Epoch 85/100] Current temperature: 0.1500
[Epoch 85] Total loss: 2.4220 | PINN loss: 2.3515 | Contrastive loss: 4.7058 | PDE loss: 0.0018 | Physics loss: 0.0326
[Epoch 86/100] Current temperature: 0.1500
[Epoch 86] Total loss: 2.0056 | PINN loss: 1.9472 | Contrastive loss: 4.7069 | PDE loss: 0.0018 | Physics loss: 0.0249
[Epoch 87/100] Current temperature: 0.1500
[Epoch 87] Total loss: 1.6982 | PINN loss: 1.6488 | Contrastive loss: 4.7066 | PDE loss: 0.0018 | Physics loss: 0.0230
[Epoch 88/100] Current temperature: 0.1500
[Epoch 88] Total loss: 1.4377 | PINN loss: 1.3958 | Contrastive loss: 4.7044 | PDE loss: 0.0018 | Physics loss: 0.0210
[Epoch 89/100] Current temperature: 0.1500
[Epoch 89] Total loss: 1.2773 | PINN loss: 1.2401 | Contrastive loss: 4.6995 | PDE loss: 0.0018 | Physics loss: 0.0221
[Epoch 90/100] Current temperature: 0.1500
[Epoch 90] Total loss: 1.1493 | PINN loss: 1.1159 | Contrastive loss: 4.7018 | PDE loss: 0.0017 | Physics loss: 0.0209
[Validation] Epoch 90: MSE = 0.421716
New best model saved at epoch 90 with validation MSE: 0.421716
[Test] MSE: 0.04110035, MAE: 0.163794, MAPE: 0.002047, RMSE: 0.202732, R²: 0.9992
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_90.png
[Epoch 91/100] Current temperature: 0.1500
[Epoch 91] Total loss: 1.0289 | PINN loss: 0.9989 | Contrastive loss: 4.6992 | PDE loss: 0.0017 | Physics loss: 0.0180
[Epoch 92/100] Current temperature: 0.1500
[Epoch 92] Total loss: 0.9667 | PINN loss: 0.9385 | Contrastive loss: 4.6986 | PDE loss: 0.0017 | Physics loss: 0.0186
[Epoch 93/100] Current temperature: 0.1500
[Epoch 93] Total loss: 0.9162 | PINN loss: 0.8896 | Contrastive loss: 4.6947 | PDE loss: 0.0017 | Physics loss: 0.0166
[Epoch 94/100] Current temperature: 0.1500
[Epoch 94] Total loss: 0.8874 | PINN loss: 0.8616 | Contrastive loss: 4.6956 | PDE loss: 0.0017 | Physics loss: 0.0174
[Epoch 95/100] Current temperature: 0.1500
[Epoch 95] Total loss: 0.8637 | PINN loss: 0.8385 | Contrastive loss: 4.6962 | PDE loss: 0.0017 | Physics loss: 0.0163
[Epoch 96/100] Current temperature: 0.1500
[Epoch 96] Total loss: 0.8401 | PINN loss: 0.8157 | Contrastive loss: 4.6977 | PDE loss: 0.0017 | Physics loss: 0.0165
[Epoch 97/100] Current temperature: 0.1500
[Epoch 97] Total loss: 0.8362 | PINN loss: 0.8118 | Contrastive loss: 4.6966 | PDE loss: 0.0017 | Physics loss: 0.0174
[Epoch 98/100] Current temperature: 0.1500
[Epoch 98] Total loss: 0.8207 | PINN loss: 0.7968 | Contrastive loss: 4.6955 | PDE loss: 0.0017 | Physics loss: 0.0156
[Epoch 99/100] Current temperature: 0.1500
[Epoch 99] Total loss: 0.8200 | PINN loss: 0.7961 | Contrastive loss: 4.6962 | PDE loss: 0.0017 | Physics loss: 0.0162
[Epoch 100/100] Current temperature: 0.1500
[Epoch 100] Total loss: 0.8092 | PINN loss: 0.7857 | Contrastive loss: 4.6939 | PDE loss: 0.0017 | Physics loss: 0.0166
[Validation] Epoch 100: MSE = 0.136730
New best model saved at epoch 100 with validation MSE: 0.136730
[Test] MSE: 0.03430052, MAE: 0.150692, MAPE: 0.001851, RMSE: 0.185204, R²: 0.9993
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_100.png
/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/numpy/lib/function_base.py:2559: RuntimeWarning: invalid value encountered in true_divide
  c /= stddev[:, None]
/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/numpy/lib/function_base.py:2560: RuntimeWarning: invalid value encountered in true_divide
  c /= stddev[None, :]
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/final_prediction_scatter.png
Could not load best model for final visualization: name 'stats' is not defined
Training completed. Best model at epoch 100 with validation MSE: 0.136730
