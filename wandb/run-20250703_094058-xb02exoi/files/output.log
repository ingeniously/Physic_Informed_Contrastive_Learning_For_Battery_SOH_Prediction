Loading original dataset...
Original dataset loaded: 683 training batches
Loading augmented dataset...
Augmented dataset loaded: 2065 training batches
Initializing PINN model...
2025-07-03 09:41 - function:_save_args - INFO - Args:
2025-07-03 09:41 - function:_save_args - CRITICAL - 	csv_file:/home/choi/PICL/data_processed/preprocessed_battery_health_dataset_all_points.csv
2025-07-03 09:41 - function:_save_args - CRITICAL - 	csv_file_augmented:/home/choi/PICL/data_augmentation/battery_phys_augmented.csv
2025-07-03 09:41 - function:_save_args - CRITICAL - 	batch_size:128
2025-07-03 09:41 - function:_save_args - CRITICAL - 	normalization_method:z-score
2025-07-03 09:41 - function:_save_args - CRITICAL - 	epochs:50
2025-07-03 09:41 - function:_save_args - CRITICAL - 	early_stop:30
2025-07-03 09:41 - function:_save_args - CRITICAL - 	lr:0.0005
2025-07-03 09:41 - function:_save_args - CRITICAL - 	lr_F:0.0005
2025-07-03 09:41 - function:_save_args - CRITICAL - 	save_folder:result_small_sample_05_06_07_18
2025-07-03 09:41 - function:_save_args - CRITICAL - 	alpha:1.0
2025-07-03 09:41 - function:_save_args - CRITICAL - 	beta:0.5
2025-07-03 09:41 - function:_save_args - CRITICAL - 	contrastive_weight:0.1
2025-07-03 09:41 - function:_save_args - CRITICAL - 	pinn_weight:1.0
2025-07-03 09:41 - function:_save_args - CRITICAL - 	temperature:0.1
2025-07-03 09:41 - function:_save_args - CRITICAL - 	log_dir:training_log.txt
2025-07-03 09:41 - function:_save_args - CRITICAL - 	F_layers_num:4
2025-07-03 09:41 - function:_save_args - CRITICAL - 	F_hidden_dim:128
2025-07-03 09:41 - function:_save_args - CRITICAL - 	warmup_lr:0.0001
2025-07-03 09:41 - function:_save_args - CRITICAL - 	final_lr:1e-05
2025-07-03 09:41 - function:_save_args - CRITICAL - 	warmup_epochs:50
2025-07-03 09:41 - function:_save_args - CRITICAL - 	momentum:0.999
2025-07-03 09:41 - function:_save_args - CRITICAL - 	projection_dim:128
2025-07-03 09:41 - function:_save_args - CRITICAL - 	queue_size:4096
2025-07-03 09:41 - function:_save_args - CRITICAL - 	seed:42
2025-07-03 09:41 - function:_save_args - CRITICAL - 	wandb_project:battery-picle
2025-07-03 09:41 - function:_save_args - CRITICAL - 	wandb_entity:None
2025-07-03 09:41 - function:_save_args - CRITICAL - 	wandb_run_name:None
Could not create model visualization for wandb
Setting up contrastive learning wrapper...
PINN model has 41986 trainable parameters
Full contrastive wrapper has 84098 trainable parameters
Starting training...
[Epoch 1] Total loss: 6296.7991 | PINN loss: 6296.6448 | Contrastive loss: 5.1445 | PDE loss: 0.0386 | Physics loss: 1.7909
[Validation] Epoch 1: MSE = 5948.467285
New best model saved at epoch 1 with validation MSE: 5948.467285
[Test] MSE: 5765.62011719, MAE: 75.607086, MAPE: 13.185694, RMSE: 75.931679, R²: -116.2771
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_1.png
[Epoch 2] Total loss: 5829.6714 | PINN loss: 5829.5229 | Contrastive loss: 4.9502 | PDE loss: 0.0078 | Physics loss: 1.1631
[Epoch 3] Total loss: 5561.9754 | PINN loss: 5561.8282 | Contrastive loss: 4.9073 | PDE loss: 0.0050 | Physics loss: 1.1119
[Epoch 4] Total loss: 5340.1559 | PINN loss: 5340.0092 | Contrastive loss: 4.8903 | PDE loss: 0.0038 | Physics loss: 1.1056
[Epoch 5] Total loss: 5153.7896 | PINN loss: 5153.6436 | Contrastive loss: 4.8656 | PDE loss: 0.0033 | Physics loss: 1.1000
[Epoch 6] Total loss: 4999.8007 | PINN loss: 4999.6552 | Contrastive loss: 4.8506 | PDE loss: 0.0029 | Physics loss: 1.0951
[Epoch 7] Total loss: 4888.5747 | PINN loss: 4888.4294 | Contrastive loss: 4.8438 | PDE loss: 0.0026 | Physics loss: 1.0931
[Epoch 8] Total loss: 4808.5904 | PINN loss: 4808.4454 | Contrastive loss: 4.8332 | PDE loss: 0.0024 | Physics loss: 1.0884
[Epoch 9] Total loss: 4755.1155 | PINN loss: 4754.9706 | Contrastive loss: 4.8304 | PDE loss: 0.0024 | Physics loss: 1.1042
[Epoch 10] Total loss: 4727.7521 | PINN loss: 4727.6075 | Contrastive loss: 4.8209 | PDE loss: 0.0023 | Physics loss: 1.0930
[Validation] Epoch 10: MSE = 4707.634766
New best model saved at epoch 10 with validation MSE: 4707.634766
[Test] MSE: 4543.83789062, MAE: 67.042191, MAPE: 4.687657, RMSE: 67.407997, R²: -91.4251
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_10.png
[Epoch 11] Total loss: 4602.9352 | PINN loss: 4602.7898 | Contrastive loss: 4.8460 | PDE loss: 0.0023 | Physics loss: 1.0744
[Epoch 12] Total loss: 4371.7511 | PINN loss: 4371.6056 | Contrastive loss: 4.8488 | PDE loss: 0.0021 | Physics loss: 1.0728
[Epoch 13] Total loss: 4149.1052 | PINN loss: 4148.9601 | Contrastive loss: 4.8365 | PDE loss: 0.0020 | Physics loss: 1.0566
Contrastive weight adjusted to 0.0500
[Epoch 14] Total loss: 3936.1355 | PINN loss: 3935.8932 | Contrastive loss: 4.8464 | PDE loss: 0.0019 | Physics loss: 1.0338
Contrastive weight adjusted to 0.0500
[Epoch 15] Total loss: 3736.3008 | PINN loss: 3736.0590 | Contrastive loss: 4.8362 | PDE loss: 0.0018 | Physics loss: 1.0134
Contrastive weight adjusted to 0.0500
[Epoch 16] Total loss: 3552.5477 | PINN loss: 3552.3064 | Contrastive loss: 4.8264 | PDE loss: 0.0018 | Physics loss: 0.9895
Contrastive weight adjusted to 0.0500
[Epoch 17] Total loss: 3378.3237 | PINN loss: 3378.0829 | Contrastive loss: 4.8165 | PDE loss: 0.0018 | Physics loss: 0.9635
Contrastive weight adjusted to 0.0500
[Epoch 18] Total loss: 3223.0420 | PINN loss: 3222.8013 | Contrastive loss: 4.8145 | PDE loss: 0.0017 | Physics loss: 0.9434
Contrastive weight adjusted to 0.0500
[Epoch 19] Total loss: 3085.3237 | PINN loss: 3085.0833 | Contrastive loss: 4.8083 | PDE loss: 0.0017 | Physics loss: 0.9307
Contrastive weight adjusted to 0.0500
[Epoch 20] Total loss: 2963.8442 | PINN loss: 2963.6040 | Contrastive loss: 4.8029 | PDE loss: 0.0017 | Physics loss: 0.9128
[Validation] Epoch 20: MSE = 2903.913086
New best model saved at epoch 20 with validation MSE: 2903.913086
[Test] MSE: 2772.82202148, MAE: 52.188477, MAPE: 1.789949, RMSE: 52.657593, R²: -55.4013
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_20.png
Contrastive weight adjusted to 0.0500
[Epoch 21] Total loss: 2855.7890 | PINN loss: 2855.5491 | Contrastive loss: 4.7976 | PDE loss: 0.0017 | Physics loss: 0.9016
Contrastive weight adjusted to 0.0500
[Epoch 22] Total loss: 2765.0200 | PINN loss: 2764.7802 | Contrastive loss: 4.7964 | PDE loss: 0.0016 | Physics loss: 0.8873
Contrastive weight adjusted to 0.0500
[Epoch 23] Total loss: 2691.3723 | PINN loss: 2691.1329 | Contrastive loss: 4.7896 | PDE loss: 0.0016 | Physics loss: 0.8780
Contrastive weight adjusted to 0.0500
[Epoch 24] Total loss: 2624.2850 | PINN loss: 2624.0458 | Contrastive loss: 4.7827 | PDE loss: 0.0016 | Physics loss: 0.8741
Contrastive weight adjusted to 0.0500
[Epoch 25] Total loss: 2571.8095 | PINN loss: 2571.5703 | Contrastive loss: 4.7843 | PDE loss: 0.0016 | Physics loss: 0.8707
Contrastive weight adjusted to 0.0500
[Epoch 26] Total loss: 2533.1316 | PINN loss: 2532.8927 | Contrastive loss: 4.7795 | PDE loss: 0.0016 | Physics loss: 0.8558
Contrastive weight adjusted to 0.0500
[Epoch 27] Total loss: 2503.0332 | PINN loss: 2502.7943 | Contrastive loss: 4.7795 | PDE loss: 0.0016 | Physics loss: 0.8475
Contrastive weight adjusted to 0.0500
[Epoch 28] Total loss: 2478.9590 | PINN loss: 2478.7202 | Contrastive loss: 4.7771 | PDE loss: 0.0016 | Physics loss: 0.8578
Contrastive weight adjusted to 0.0500
[Epoch 29] Total loss: 2459.1993 | PINN loss: 2458.9606 | Contrastive loss: 4.7724 | PDE loss: 0.0016 | Physics loss: 0.8465
Contrastive weight adjusted to 0.0500
[Epoch 30] Total loss: 2448.3758 | PINN loss: 2448.1372 | Contrastive loss: 4.7724 | PDE loss: 0.0016 | Physics loss: 0.8498
[Validation] Epoch 30: MSE = 2440.813721
New best model saved at epoch 30 with validation MSE: 2440.813721
[Test] MSE: 2319.70092773, MAE: 47.649925, MAPE: 1.414153, RMSE: 48.163273, R²: -46.1845
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_30.png
Contrastive weight adjusted to 0.0500
[Epoch 31] Total loss: 2356.1845 | PINN loss: 2355.9444 | Contrastive loss: 4.8003 | PDE loss: 0.0017 | Physics loss: 0.8431
Contrastive weight adjusted to 0.0500
[Epoch 32] Total loss: 2193.3448 | PINN loss: 2193.1045 | Contrastive loss: 4.8062 | PDE loss: 0.0017 | Physics loss: 0.8282
Contrastive weight adjusted to 0.0500
[Epoch 33] Total loss: 2034.1261 | PINN loss: 2033.8859 | Contrastive loss: 4.8031 | PDE loss: 0.0017 | Physics loss: 0.8232
Contrastive weight adjusted to 0.0500
[Epoch 34] Total loss: 1883.1510 | PINN loss: 1882.9106 | Contrastive loss: 4.8088 | PDE loss: 0.0016 | Physics loss: 0.8141
Contrastive weight adjusted to 0.0500
[Epoch 35] Total loss: 1740.1479 | PINN loss: 1739.9076 | Contrastive loss: 4.8069 | PDE loss: 0.0016 | Physics loss: 0.8075
Contrastive weight adjusted to 0.0500
[Epoch 36] Total loss: 1603.4564 | PINN loss: 1603.2162 | Contrastive loss: 4.8041 | PDE loss: 0.0016 | Physics loss: 0.8058
Contrastive weight adjusted to 0.0500
[Epoch 37] Total loss: 1476.6425 | PINN loss: 1476.4023 | Contrastive loss: 4.8041 | PDE loss: 0.0017 | Physics loss: 0.8116
Contrastive weight adjusted to 0.0500
[Epoch 38] Total loss: 1355.6425 | PINN loss: 1355.4024 | Contrastive loss: 4.8005 | PDE loss: 0.0016 | Physics loss: 0.8088
Contrastive weight adjusted to 0.0500
[Epoch 39] Total loss: 1242.7605 | PINN loss: 1242.5206 | Contrastive loss: 4.7966 | PDE loss: 0.0016 | Physics loss: 0.8102
Contrastive weight adjusted to 0.0500
[Epoch 40] Total loss: 1137.5338 | PINN loss: 1137.2940 | Contrastive loss: 4.7966 | PDE loss: 0.0016 | Physics loss: 0.8043
[Validation] Epoch 40: MSE = 1089.482544
New best model saved at epoch 40 with validation MSE: 1089.482544
[Test] MSE: 1005.19055176, MAE: 30.919338, MAPE: 0.613167, RMSE: 31.704741, R²: -19.4463
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_40.png
Contrastive weight adjusted to 0.0500
[Epoch 41] Total loss: 1040.2570 | PINN loss: 1040.0171 | Contrastive loss: 4.7967 | PDE loss: 0.0016 | Physics loss: 0.8033
Contrastive weight adjusted to 0.0500
[Epoch 42] Total loss: 948.2518 | PINN loss: 948.0123 | Contrastive loss: 4.7917 | PDE loss: 0.0016 | Physics loss: 0.8017
Contrastive weight adjusted to 0.0500
[Epoch 43] Total loss: 866.9817 | PINN loss: 866.7421 | Contrastive loss: 4.7904 | PDE loss: 0.0016 | Physics loss: 0.8033
Contrastive weight adjusted to 0.0500
[Epoch 44] Total loss: 789.7315 | PINN loss: 789.4922 | Contrastive loss: 4.7859 | PDE loss: 0.0016 | Physics loss: 0.7995
Contrastive weight adjusted to 0.0500
[Epoch 45] Total loss: 720.3965 | PINN loss: 720.1570 | Contrastive loss: 4.7889 | PDE loss: 0.0016 | Physics loss: 0.8185
Contrastive weight adjusted to 0.0500
[Epoch 46] Total loss: 656.7299 | PINN loss: 656.4906 | Contrastive loss: 4.7857 | PDE loss: 0.0016 | Physics loss: 0.8036
Contrastive weight adjusted to 0.0500
[Epoch 47] Total loss: 599.4345 | PINN loss: 599.1955 | Contrastive loss: 4.7792 | PDE loss: 0.0016 | Physics loss: 0.8014
Contrastive weight adjusted to 0.0500
[Epoch 48] Total loss: 547.3105 | PINN loss: 547.0716 | Contrastive loss: 4.7791 | PDE loss: 0.0016 | Physics loss: 0.7993
Contrastive weight adjusted to 0.0500
[Epoch 49] Total loss: 501.6030 | PINN loss: 501.3641 | Contrastive loss: 4.7782 | PDE loss: 0.0016 | Physics loss: 0.8081
Contrastive weight adjusted to 0.0500
[Epoch 50] Total loss: 459.2302 | PINN loss: 458.9914 | Contrastive loss: 4.7759 | PDE loss: 0.0016 | Physics loss: 0.8027
[Validation] Epoch 50: MSE = 441.211243
New best model saved at epoch 50 with validation MSE: 441.211243
[Test] MSE: 384.65515137, MAE: 18.315845, MAPE: 0.290596, RMSE: 19.612627, R²: -6.8242
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_50.png
/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/numpy/lib/function_base.py:2559: RuntimeWarning: invalid value encountered in true_divide
  c /= stddev[:, None]
/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/numpy/lib/function_base.py:2560: RuntimeWarning: invalid value encountered in true_divide
  c /= stddev[None, :]
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/final_prediction_scatter.png
Could not load best model for final visualization: name 'stats' is not defined
Training completed. Best model at epoch 50 with validation MSE: 441.211243
