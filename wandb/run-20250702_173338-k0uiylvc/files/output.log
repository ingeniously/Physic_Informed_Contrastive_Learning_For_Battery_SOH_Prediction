Loading original dataset...
Original dataset loaded: 683 training batches
Loading augmented dataset...
Augmented dataset loaded: 2065 training batches
Initializing PINN model...
2025-07-02 17:33 - function:_save_args - INFO - Args:
2025-07-02 17:33 - function:_save_args - CRITICAL - 	csv_file:/home/choi/PICL/data_processed/preprocessed_battery_health_dataset_all_points.csv
2025-07-02 17:33 - function:_save_args - CRITICAL - 	csv_file_augmented:/home/choi/PICL/data_augmentation/battery_phys_augmented.csv
2025-07-02 17:33 - function:_save_args - CRITICAL - 	batch_size:128
2025-07-02 17:33 - function:_save_args - CRITICAL - 	normalization_method:z-score
2025-07-02 17:33 - function:_save_args - CRITICAL - 	epochs:100
2025-07-02 17:33 - function:_save_args - CRITICAL - 	early_stop:30
2025-07-02 17:33 - function:_save_args - CRITICAL - 	lr:0.0005
2025-07-02 17:33 - function:_save_args - CRITICAL - 	lr_F:0.0005
2025-07-02 17:33 - function:_save_args - CRITICAL - 	save_folder:result_small_sample_05_06_07_18
2025-07-02 17:33 - function:_save_args - CRITICAL - 	alpha:1.0
2025-07-02 17:33 - function:_save_args - CRITICAL - 	beta:0.5
2025-07-02 17:33 - function:_save_args - CRITICAL - 	contrastive_weight:0.1
2025-07-02 17:33 - function:_save_args - CRITICAL - 	pinn_weight:1.0
2025-07-02 17:33 - function:_save_args - CRITICAL - 	temperature:0.1
2025-07-02 17:33 - function:_save_args - CRITICAL - 	log_dir:training_log.txt
2025-07-02 17:33 - function:_save_args - CRITICAL - 	F_layers_num:4
2025-07-02 17:33 - function:_save_args - CRITICAL - 	F_hidden_dim:128
2025-07-02 17:33 - function:_save_args - CRITICAL - 	warmup_lr:0.0001
2025-07-02 17:33 - function:_save_args - CRITICAL - 	final_lr:1e-05
2025-07-02 17:33 - function:_save_args - CRITICAL - 	warmup_epochs:50
2025-07-02 17:33 - function:_save_args - CRITICAL - 	momentum:0.999
2025-07-02 17:33 - function:_save_args - CRITICAL - 	projection_dim:128
2025-07-02 17:33 - function:_save_args - CRITICAL - 	queue_size:4096
2025-07-02 17:33 - function:_save_args - CRITICAL - 	seed:42
2025-07-02 17:33 - function:_save_args - CRITICAL - 	wandb_project:battery-picl
2025-07-02 17:33 - function:_save_args - CRITICAL - 	wandb_entity:None
2025-07-02 17:33 - function:_save_args - CRITICAL - 	wandb_run_name:None
Could not create model visualization for wandb
Setting up contrastive learning wrapper...
PINN model has 41986 trainable parameters
Full contrastive wrapper has 84098 trainable parameters
Starting training...
[Epoch 1] Total loss: 6296.7991 | PINN loss: 6296.6448 | Contrastive loss: 5.1445 | PDE loss: 0.0386 | Physics loss: 1.7909
[Validation] Epoch 1: MSE = 5948.467285
New best model saved at epoch 1 with validation MSE: 5948.467285
[Test] MSE: 5765.62011719, MAE: 75.607086, MAPE: 13.185694, RMSE: 75.931679, R²: -116.2771
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_1.png
[Epoch 2] Total loss: 5829.6714 | PINN loss: 5829.5229 | Contrastive loss: 4.9502 | PDE loss: 0.0078 | Physics loss: 1.1631
[Epoch 3] Total loss: 5561.9754 | PINN loss: 5561.8282 | Contrastive loss: 4.9073 | PDE loss: 0.0050 | Physics loss: 1.1119
[Validation] Epoch 3: MSE = 5427.355957
New best model saved at epoch 3 with validation MSE: 5427.355957
[Test] MSE: 5252.26123047, MAE: 72.132339, MAPE: 7.831443, RMSE: 72.472488, R²: -105.8350
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_3.png
[Epoch 4] Total loss: 5343.2841 | PINN loss: 5343.1376 | Contrastive loss: 4.8847 | PDE loss: 0.0039 | Physics loss: 1.0995
[Epoch 5] Total loss: 5151.9934 | PINN loss: 5151.8473 | Contrastive loss: 4.8696 | PDE loss: 0.0032 | Physics loss: 1.1097
[Epoch 6] Total loss: 5000.1726 | PINN loss: 5000.0271 | Contrastive loss: 4.8516 | PDE loss: 0.0029 | Physics loss: 1.1010
[Validation] Epoch 6: MSE = 4922.521484
New best model saved at epoch 6 with validation MSE: 4922.521484
[Test] MSE: 4755.33886719, MAE: 68.601494, MAPE: 5.383712, RMSE: 68.958961, R²: -95.7272
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_6.png
[Epoch 7] Total loss: 4890.4045 | PINN loss: 4890.2593 | Contrastive loss: 4.8407 | PDE loss: 0.0026 | Physics loss: 1.1187
Traceback (most recent call last):
  File "main.py", line 931, in <module>
    main()
  File "main.py", line 925, in main
    train_contrastive_pinn(wrapper, orig_loader, aug_loader, args)
  File "main.py", line 187, in train_contrastive_pinn
    total_loss.backward()
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/tensor.py", line 221, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/autograd/__init__.py", line 132, in backward
    allow_unreachable=True)  # allow_unreachable flag
KeyboardInterrupt
