Loading original dataset...
Original dataset loaded: 683 training batches
Loading augmented dataset...
Augmented dataset loaded: 2065 training batches
Initializing PINN model...
2025-07-03 15:24 - function:_save_args - INFO - Args:
2025-07-03 15:24 - function:_save_args - CRITICAL - 	csv_file:/home/choi/PICL/data_processed/preprocessed_battery_health_dataset_all_points.csv
2025-07-03 15:24 - function:_save_args - CRITICAL - 	csv_file_augmented:/home/choi/PICL/data_augmentation/battery_phys_augmented.csv
2025-07-03 15:24 - function:_save_args - CRITICAL - 	batch_size:128
2025-07-03 15:24 - function:_save_args - CRITICAL - 	normalization_method:z-score
2025-07-03 15:24 - function:_save_args - CRITICAL - 	epochs:50
2025-07-03 15:24 - function:_save_args - CRITICAL - 	early_stop:30
2025-07-03 15:24 - function:_save_args - CRITICAL - 	lr:0.0001
2025-07-03 15:24 - function:_save_args - CRITICAL - 	lr_F:0.0005
2025-07-03 15:24 - function:_save_args - CRITICAL - 	save_folder:result_small_sample_05_06_07_18
2025-07-03 15:24 - function:_save_args - CRITICAL - 	alpha:1.0
2025-07-03 15:24 - function:_save_args - CRITICAL - 	beta:0.5
2025-07-03 15:24 - function:_save_args - CRITICAL - 	contrastive_weight:0.5
2025-07-03 15:24 - function:_save_args - CRITICAL - 	pinn_weight:1.0
2025-07-03 15:24 - function:_save_args - CRITICAL - 	temperature:0.05
2025-07-03 15:24 - function:_save_args - CRITICAL - 	log_dir:training_log.txt
2025-07-03 15:24 - function:_save_args - CRITICAL - 	F_layers_num:4
2025-07-03 15:24 - function:_save_args - CRITICAL - 	F_hidden_dim:128
2025-07-03 15:24 - function:_save_args - CRITICAL - 	warmup_lr:0.0001
2025-07-03 15:24 - function:_save_args - CRITICAL - 	final_lr:1e-05
2025-07-03 15:24 - function:_save_args - CRITICAL - 	warmup_epochs:50
2025-07-03 15:24 - function:_save_args - CRITICAL - 	momentum:0.99
2025-07-03 15:24 - function:_save_args - CRITICAL - 	projection_dim:128
2025-07-03 15:24 - function:_save_args - CRITICAL - 	queue_size:4096
2025-07-03 15:24 - function:_save_args - CRITICAL - 	seed:42
2025-07-03 15:24 - function:_save_args - CRITICAL - 	wandb_project:battery-picle
2025-07-03 15:24 - function:_save_args - CRITICAL - 	wandb_entity:None
2025-07-03 15:24 - function:_save_args - CRITICAL - 	wandb_run_name:None
Could not create model visualization for wandb
Setting up contrastive learning wrapper...
PINN model has 41986 trainable parameters
Full contrastive wrapper has 158594 trainable parameters
Starting training...
[Epoch 1] Total loss: 6761.9322 | PINN loss: 6761.1383 | Contrastive loss: 5.2929 | PDE loss: 0.0901 | Physics loss: 2.3688
[Validation] Epoch 1: MSE = 6574.060059
New best model saved at epoch 1 with validation MSE: 6574.060059
[Test] MSE: 6461.56933594, MAE: 80.117104, MAPE: 133.703934, RMSE: 80.383888, R²: -130.4333
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_1.png
[Epoch 2] Total loss: 6390.3445 | PINN loss: 6389.5778 | Contrastive loss: 5.1111 | PDE loss: 0.0462 | Physics loss: 2.1785
[Epoch 3] Total loss: 6187.5369 | PINN loss: 6186.7771 | Contrastive loss: 5.0650 | PDE loss: 0.0225 | Physics loss: 1.7524
[Epoch 4] Total loss: 6107.6553 | PINN loss: 6106.9000 | Contrastive loss: 5.0353 | PDE loss: 0.0140 | Physics loss: 1.4555
[Epoch 5] Total loss: 6050.4161 | PINN loss: 6049.6624 | Contrastive loss: 5.0243 | PDE loss: 0.0102 | Physics loss: 1.3156
[Epoch 6] Total loss: 5998.5623 | PINN loss: 5997.8096 | Contrastive loss: 5.0179 | PDE loss: 0.0081 | Physics loss: 1.2094
[Epoch 7] Total loss: 5956.9637 | PINN loss: 5956.2115 | Contrastive loss: 5.0147 | PDE loss: 0.0068 | Physics loss: 1.1594
[Epoch 8] Total loss: 5918.2968 | PINN loss: 5917.5440 | Contrastive loss: 5.0185 | PDE loss: 0.0059 | Physics loss: 1.1146
[Epoch 9] Total loss: 5887.6604 | PINN loss: 5886.9075 | Contrastive loss: 5.0193 | PDE loss: 0.0054 | Physics loss: 1.0890
[Epoch 10] Total loss: 5869.2727 | PINN loss: 5868.5187 | Contrastive loss: 5.0264 | PDE loss: 0.0049 | Physics loss: 1.0790
[Validation] Epoch 10: MSE = 5835.818359
New best model saved at epoch 10 with validation MSE: 5835.818359
[Test] MSE: 5654.67431641, MAE: 74.869827, MAPE: 11.568421, RMSE: 75.197571, R²: -114.0204
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_10.png
[Epoch 11] Total loss: 5849.7464 | PINN loss: 5848.9916 | Contrastive loss: 5.0320 | PDE loss: 0.0046 | Physics loss: 1.0493
[Epoch 12] Total loss: 5833.5546 | PINN loss: 5832.7992 | Contrastive loss: 5.0363 | PDE loss: 0.0044 | Physics loss: 1.0505
[Epoch 13] Total loss: 5827.7464 | PINN loss: 5826.9884 | Contrastive loss: 5.0533 | PDE loss: 0.0043 | Physics loss: 1.0429
[Epoch 14] Total loss: 5821.1893 | PINN loss: 5820.4300 | Contrastive loss: 5.0614 | PDE loss: 0.0042 | Physics loss: 1.0360
[Epoch 15] Total loss: 5816.2194 | PINN loss: 5815.4587 | Contrastive loss: 5.0717 | PDE loss: 0.0042 | Physics loss: 1.0510
[Epoch 16] Total loss: 5786.9355 | PINN loss: 5786.1730 | Contrastive loss: 5.0832 | PDE loss: 0.0038 | Physics loss: 1.0257
[Epoch 17] Total loss: 5735.5402 | PINN loss: 5734.7769 | Contrastive loss: 5.0888 | PDE loss: 0.0033 | Physics loss: 1.0081
[Epoch 18] Total loss: 5679.6937 | PINN loss: 5678.9295 | Contrastive loss: 5.0948 | PDE loss: 0.0030 | Physics loss: 1.0079
[Epoch 19] Total loss: 5626.6168 | PINN loss: 5625.8522 | Contrastive loss: 5.0976 | PDE loss: 0.0028 | Physics loss: 0.9843
[Epoch 20] Total loss: 5578.7342 | PINN loss: 5577.9685 | Contrastive loss: 5.1046 | PDE loss: 0.0026 | Physics loss: 0.9922
[Validation] Epoch 20: MSE = 5541.178223
New best model saved at epoch 20 with validation MSE: 5541.178223
[Test] MSE: 5364.46386719, MAE: 72.905975, MAPE: 8.641485, RMSE: 73.242500, R²: -108.1173
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_20.png
[Epoch 21] Total loss: 5529.2249 | PINN loss: 5528.4584 | Contrastive loss: 5.1104 | PDE loss: 0.0025 | Physics loss: 0.9908
[Epoch 22] Total loss: 5480.8741 | PINN loss: 5480.1062 | Contrastive loss: 5.1195 | PDE loss: 0.0023 | Physics loss: 0.9692
[Epoch 23] Total loss: 5433.2196 | PINN loss: 5432.4503 | Contrastive loss: 5.1282 | PDE loss: 0.0023 | Physics loss: 0.9804
[Epoch 24] Total loss: 5388.5587 | PINN loss: 5387.7884 | Contrastive loss: 5.1358 | PDE loss: 0.0022 | Physics loss: 0.9925
[Epoch 25] Total loss: 5347.6398 | PINN loss: 5346.8681 | Contrastive loss: 5.1449 | PDE loss: 0.0021 | Physics loss: 0.9859
[Epoch 26] Total loss: 5309.2116 | PINN loss: 5308.4375 | Contrastive loss: 5.1609 | PDE loss: 0.0021 | Physics loss: 0.9870
[Epoch 27] Total loss: 5270.8780 | PINN loss: 5270.1027 | Contrastive loss: 5.1689 | PDE loss: 0.0020 | Physics loss: 0.9743
[Epoch 28] Total loss: 5237.8152 | PINN loss: 5237.0375 | Contrastive loss: 5.1845 | PDE loss: 0.0020 | Physics loss: 0.9733
[Epoch 29] Total loss: 5204.3239 | PINN loss: 5203.5448 | Contrastive loss: 5.1937 | PDE loss: 0.0019 | Physics loss: 0.9745
[Epoch 30] Total loss: 5175.6869 | PINN loss: 5174.9057 | Contrastive loss: 5.2077 | PDE loss: 0.0019 | Physics loss: 0.9697
[Validation] Epoch 30: MSE = 5152.383301
New best model saved at epoch 30 with validation MSE: 5152.383301
[Test] MSE: 4981.55322266, MAE: 70.230843, MAPE: 6.319888, RMSE: 70.580116, R²: -100.3286
Enhanced prediction scatter plot saved to result_small_sample_05_06_07_18/prediction_scatter_epoch_30.png
[Epoch 31] Total loss: 5146.7765 | PINN loss: 5145.9921 | Contrastive loss: 5.2291 | PDE loss: 0.0019 | Physics loss: 0.9702
[Epoch 32] Total loss: 5122.0649 | PINN loss: 5121.2790 | Contrastive loss: 5.2391 | PDE loss: 0.0019 | Physics loss: 0.9706
[Epoch 33] Total loss: 5101.6503 | PINN loss: 5100.8616 | Contrastive loss: 5.2581 | PDE loss: 0.0019 | Physics loss: 0.9859
[Epoch 34] Total loss: 5084.3982 | PINN loss: 5083.6067 | Contrastive loss: 5.2768 | PDE loss: 0.0019 | Physics loss: 0.9705
[Epoch 35] Total loss: 5065.5384 | PINN loss: 5064.7438 | Contrastive loss: 5.2975 | PDE loss: 0.0019 | Physics loss: 0.9720
[Epoch 36] Total loss: 5051.6421 | PINN loss: 5050.8451 | Contrastive loss: 5.3139 | PDE loss: 0.0018 | Physics loss: 0.9762
[Epoch 37] Total loss: 5035.3333 | PINN loss: 5034.5371 | Contrastive loss: 5.3079 | PDE loss: 0.0018 | Physics loss: 0.9601
Traceback (most recent call last):
  File "main.py", line 857, in <module>
    main()
  File "main.py", line 851, in main
    train_contrastive_pinn(wrapper, orig_loader, aug_loader, args)
  File "main.py", line 177, in train_contrastive_pinn
    x1, _, y1, _ = next(orig_iter)
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 435, in __next__
    data = self._next_data()
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 475, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/utils/data/dataset.py", line 170, in __getitem__
    return tuple(tensor[index] for tensor in self.tensors)
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/utils/data/dataset.py", line 170, in <genexpr>
    return tuple(tensor[index] for tensor in self.tensors)
KeyboardInterrupt
