Original dataset loaded: 683 training batches
Augmented dataset loaded: 2065 training batches
Initializing PINN model...
2025-07-04 13:31 - function:_save_args - INFO - Args:
2025-07-04 13:31 - function:_save_args - CRITICAL - 	csv_file:/home/choi/PICL/data_processed/preprocessed_battery_health_dataset_all_points.csv
2025-07-04 13:31 - function:_save_args - CRITICAL - 	csv_file_augmented:/home/choi/PICL/data_augmentation/battery_phys_augmented.csv
2025-07-04 13:31 - function:_save_args - CRITICAL - 	batch_size:128
2025-07-04 13:31 - function:_save_args - CRITICAL - 	normalization_method:z-score
2025-07-04 13:31 - function:_save_args - CRITICAL - 	epochs:100
2025-07-04 13:31 - function:_save_args - CRITICAL - 	early_stop:30
2025-07-04 13:31 - function:_save_args - CRITICAL - 	lr:0.0005
2025-07-04 13:31 - function:_save_args - CRITICAL - 	lr_F:0.0005
2025-07-04 13:31 - function:_save_args - CRITICAL - 	save_folder:result_small_sample_05_06_07_18
2025-07-04 13:31 - function:_save_args - CRITICAL - 	alpha:1.0
2025-07-04 13:31 - function:_save_args - CRITICAL - 	beta:1.0
2025-07-04 13:31 - function:_save_args - CRITICAL - 	contrastive_weight:0.5
2025-07-04 13:31 - function:_save_args - CRITICAL - 	pinn_weight:1.0
2025-07-04 13:31 - function:_save_args - CRITICAL - 	temperature:0.1
2025-07-04 13:31 - function:_save_args - CRITICAL - 	log_dir:training_log.txt
2025-07-04 13:31 - function:_save_args - CRITICAL - 	F_layers_num:4
2025-07-04 13:31 - function:_save_args - CRITICAL - 	F_hidden_dim:128
2025-07-04 13:31 - function:_save_args - CRITICAL - 	warmup_lr:0.0001
2025-07-04 13:31 - function:_save_args - CRITICAL - 	final_lr:1e-05
2025-07-04 13:31 - function:_save_args - CRITICAL - 	warmup_epochs:50
2025-07-04 13:31 - function:_save_args - CRITICAL - 	momentum:0.999
2025-07-04 13:31 - function:_save_args - CRITICAL - 	projection_dim:128
2025-07-04 13:31 - function:_save_args - CRITICAL - 	queue_size:4096
2025-07-04 13:31 - function:_save_args - CRITICAL - 	seed:42
2025-07-04 13:31 - function:_save_args - CRITICAL - 	wandb_project:battery-picle-small-dataset
2025-07-04 13:31 - function:_save_args - CRITICAL - 	wandb_entity:None
2025-07-04 13:31 - function:_save_args - CRITICAL - 	wandb_run_name:None
Could not create model visualization for wandb
Setting up contrastive learning ...
Starting training...
[Epoch 1] Total loss: 6294.8288 | PINN loss: 6294.1195 | Contrastive loss: 4.7290 | PDE loss: 0.0382 | Physics loss: 1.6926
[Validation] Epoch 1: MSE = 5948.549316
New best model saved at epoch 1 with validation MSE: 5948.549316
[Test] MSE: 5765.66406250, MAE: 75.607422, MAPE: 13.186543, RMSE: 75.931969, R²: -116.2780
[Epoch 2] Total loss: 5832.9949 | PINN loss: 5832.2922 | Contrastive loss: 4.6843 | PDE loss: 0.0077 | Physics loss: 1.1530
[Epoch 3] Total loss: 5556.8151 | PINN loss: 5556.1137 | Contrastive loss: 4.6759 | PDE loss: 0.0049 | Physics loss: 1.1086
[Epoch 4] Total loss: 5314.7610 | PINN loss: 5314.0603 | Contrastive loss: 4.6715 | PDE loss: 0.0038 | Physics loss: 1.1239
[Epoch 5] Total loss: 5094.1918 | PINN loss: 5093.4916 | Contrastive loss: 4.6683 | PDE loss: 0.0031 | Physics loss: 1.1180
[Epoch 6] Total loss: 4898.4994 | PINN loss: 4897.7998 | Contrastive loss: 4.6637 | PDE loss: 0.0027 | Physics loss: 1.1131
[Epoch 7] Total loss: 4731.4654 | PINN loss: 4730.7659 | Contrastive loss: 4.6629 | PDE loss: 0.0025 | Physics loss: 1.0980
[Epoch 8] Total loss: 4585.4712 | PINN loss: 4584.7723 | Contrastive loss: 4.6596 | PDE loss: 0.0023 | Physics loss: 1.0972
[Epoch 9] Total loss: 4468.1382 | PINN loss: 4467.4396 | Contrastive loss: 4.6578 | PDE loss: 0.0022 | Physics loss: 1.0740
[Epoch 10] Total loss: 4376.1370 | PINN loss: 4375.4383 | Contrastive loss: 4.6578 | PDE loss: 0.0021 | Physics loss: 1.0846
[Validation] Epoch 10: MSE = 4323.866211
New best model saved at epoch 10 with validation MSE: 4323.866211
[Test] MSE: 4166.34472656, MAE: 64.165100, MAPE: 3.735039, RMSE: 64.547226, R²: -83.7466
[Epoch 11] Total loss: 4305.6530 | PINN loss: 4304.9545 | Contrastive loss: 4.6567 | PDE loss: 0.0020 | Physics loss: 1.0752
[Epoch 12] Total loss: 4258.2289 | PINN loss: 4257.5307 | Contrastive loss: 4.6551 | PDE loss: 0.0020 | Physics loss: 1.0682
[Epoch 13] Total loss: 4226.9752 | PINN loss: 4226.2770 | Contrastive loss: 4.6542 | PDE loss: 0.0019 | Physics loss: 1.0661
[Epoch 14] Total loss: 4208.8314 | PINN loss: 4208.1333 | Contrastive loss: 4.6540 | PDE loss: 0.0019 | Physics loss: 1.0701
[Epoch 15] Total loss: 4198.9227 | PINN loss: 4198.2242 | Contrastive loss: 4.6566 | PDE loss: 0.0019 | Physics loss: 1.0769
[Epoch 16] Total loss: 4088.4881 | PINN loss: 4087.7881 | Contrastive loss: 4.6668 | PDE loss: 0.0021 | Physics loss: 1.0582
[Epoch 17] Total loss: 3872.9831 | PINN loss: 3872.2827 | Contrastive loss: 4.6698 | PDE loss: 0.0019 | Physics loss: 1.0410
[Epoch 18] Total loss: 3663.8487 | PINN loss: 3663.1487 | Contrastive loss: 4.6667 | PDE loss: 0.0018 | Physics loss: 1.0070
[Epoch 19] Total loss: 3457.6081 | PINN loss: 3456.9079 | Contrastive loss: 4.6685 | PDE loss: 0.0018 | Physics loss: 0.9750
[Epoch 20] Total loss: 3264.1367 | PINN loss: 3263.4361 | Contrastive loss: 4.6709 | PDE loss: 0.0018 | Physics loss: 0.9637
[Validation] Epoch 20: MSE = 3163.522949
New best model saved at epoch 20 with validation MSE: 3163.522949
[Test] MSE: 3027.15600586, MAE: 54.570797, MAPE: 2.038198, RMSE: 55.019596, R²: -60.5747
[Epoch 21] Total loss: 3079.0321 | PINN loss: 3078.3311 | Contrastive loss: 4.6729 | PDE loss: 0.0017 | Physics loss: 0.9312
[Epoch 22] Total loss: 2902.1849 | PINN loss: 2901.4840 | Contrastive loss: 4.6729 | PDE loss: 0.0017 | Physics loss: 0.9079
[Epoch 23] Total loss: 2739.4459 | PINN loss: 2738.7451 | Contrastive loss: 4.6718 | PDE loss: 0.0017 | Physics loss: 0.8971
[Epoch 24] Total loss: 2586.1413 | PINN loss: 2585.4406 | Contrastive loss: 4.6714 | PDE loss: 0.0017 | Physics loss: 0.8772
[Epoch 25] Total loss: 2445.4768 | PINN loss: 2444.7758 | Contrastive loss: 4.6731 | PDE loss: 0.0017 | Physics loss: 0.8498
[Epoch 26] Total loss: 2314.8274 | PINN loss: 2314.1268 | Contrastive loss: 4.6708 | PDE loss: 0.0016 | Physics loss: 0.8426
[Epoch 27] Total loss: 2198.2067 | PINN loss: 2197.5056 | Contrastive loss: 4.6740 | PDE loss: 0.0016 | Physics loss: 0.8381
[Epoch 28] Total loss: 2086.1490 | PINN loss: 2085.4478 | Contrastive loss: 4.6746 | PDE loss: 0.0016 | Physics loss: 0.8371
[Epoch 29] Total loss: 1988.7320 | PINN loss: 1988.0310 | Contrastive loss: 4.6731 | PDE loss: 0.0016 | Physics loss: 0.8262
[Epoch 30] Total loss: 1900.0136 | PINN loss: 1899.3126 | Contrastive loss: 4.6733 | PDE loss: 0.0016 | Physics loss: 0.8171
[Validation] Epoch 30: MSE = 1859.801392
New best model saved at epoch 30 with validation MSE: 1859.801392
[Test] MSE: 1752.72448730, MAE: 41.273964, MAPE: 1.030020, RMSE: 41.865551, R²: -34.6518
[Epoch 31] Total loss: 1821.0749 | PINN loss: 1820.3737 | Contrastive loss: 4.6749 | PDE loss: 0.0016 | Physics loss: 0.8076
[Epoch 32] Total loss: 1751.7341 | PINN loss: 1751.0332 | Contrastive loss: 4.6728 | PDE loss: 0.0016 | Physics loss: 0.8196
[Epoch 33] Total loss: 1693.4099 | PINN loss: 1692.7086 | Contrastive loss: 4.6754 | PDE loss: 0.0016 | Physics loss: 0.8146
[Epoch 34] Total loss: 1638.4561 | PINN loss: 1637.7545 | Contrastive loss: 4.6773 | PDE loss: 0.0016 | Physics loss: 0.8085
[Epoch 35] Total loss: 1593.9018 | PINN loss: 1593.2003 | Contrastive loss: 4.6764 | PDE loss: 0.0016 | Physics loss: 0.8164
[Epoch 36] Total loss: 1557.9278 | PINN loss: 1557.2264 | Contrastive loss: 4.6762 | PDE loss: 0.0016 | Physics loss: 0.8087
[Epoch 37] Total loss: 1525.4202 | PINN loss: 1524.7184 | Contrastive loss: 4.6787 | PDE loss: 0.0015 | Physics loss: 0.8044
[Epoch 38] Total loss: 1500.2461 | PINN loss: 1499.5440 | Contrastive loss: 4.6805 | PDE loss: 0.0015 | Physics loss: 0.8026
[Epoch 39] Total loss: 1480.6796 | PINN loss: 1479.9779 | Contrastive loss: 4.6780 | PDE loss: 0.0015 | Physics loss: 0.8066
[Epoch 40] Total loss: 1464.6740 | PINN loss: 1463.9721 | Contrastive loss: 4.6789 | PDE loss: 0.0016 | Physics loss: 0.8075
[Validation] Epoch 40: MSE = 1459.796997
New best model saved at epoch 40 with validation MSE: 1459.796997
[Test] MSE: 1363.75866699, MAE: 36.257046, MAPE: 0.804141, RMSE: 36.929104, R²: -26.7399
[Epoch 41] Total loss: 1453.1242 | PINN loss: 1452.4220 | Contrastive loss: 4.6814 | PDE loss: 0.0015 | Physics loss: 0.8077
[Epoch 42] Total loss: 1446.4807 | PINN loss: 1445.7781 | Contrastive loss: 4.6839 | PDE loss: 0.0015 | Physics loss: 0.7915
[Epoch 43] Total loss: 1440.6231 | PINN loss: 1439.9204 | Contrastive loss: 4.6845 | PDE loss: 0.0015 | Physics loss: 0.8065
[Epoch 44] Total loss: 1437.1090 | PINN loss: 1436.4061 | Contrastive loss: 4.6862 | PDE loss: 0.0015 | Physics loss: 0.8022
[Epoch 45] Total loss: 1435.4284 | PINN loss: 1434.7256 | Contrastive loss: 4.6853 | PDE loss: 0.0015 | Physics loss: 0.8018
[Epoch 46] Total loss: 1373.0252 | PINN loss: 1372.3201 | Contrastive loss: 4.7006 | PDE loss: 0.0017 | Physics loss: 0.8000
[Epoch 47] Total loss: 1249.5612 | PINN loss: 1248.8556 | Contrastive loss: 4.7038 | PDE loss: 0.0016 | Physics loss: 0.8081
[Epoch 48] Total loss: 1132.6604 | PINN loss: 1131.9541 | Contrastive loss: 4.7085 | PDE loss: 0.0016 | Physics loss: 0.8094
[Epoch 49] Total loss: 1022.3185 | PINN loss: 1021.6115 | Contrastive loss: 4.7134 | PDE loss: 0.0016 | Physics loss: 0.8080
[Epoch 50] Total loss: 918.0267 | PINN loss: 917.3195 | Contrastive loss: 4.7152 | PDE loss: 0.0016 | Physics loss: 0.8008
[Validation] Epoch 50: MSE = 869.265686
New best model saved at epoch 50 with validation MSE: 869.265686
[Test] MSE: 792.99804688, MAE: 27.272938, MAPE: 0.504382, RMSE: 28.160221, R²: -15.1302
[Epoch 51] Total loss: 820.6101 | PINN loss: 819.9027 | Contrastive loss: 4.7164 | PDE loss: 0.0016 | Physics loss: 0.8062
[Epoch 52] Total loss: 730.0017 | PINN loss: 729.2939 | Contrastive loss: 4.7191 | PDE loss: 0.0017 | Physics loss: 0.8026
[Epoch 53] Total loss: 645.8240 | PINN loss: 645.1156 | Contrastive loss: 4.7232 | PDE loss: 0.0017 | Physics loss: 0.8050
[Epoch 54] Total loss: 567.6711 | PINN loss: 566.9624 | Contrastive loss: 4.7245 | PDE loss: 0.0016 | Physics loss: 0.8088
[Epoch 55] Total loss: 495.9362 | PINN loss: 495.2273 | Contrastive loss: 4.7262 | PDE loss: 0.0016 | Physics loss: 0.8213
[Epoch 56] Total loss: 430.9804 | PINN loss: 430.2709 | Contrastive loss: 4.7298 | PDE loss: 0.0016 | Physics loss: 0.8100
[Epoch 57] Total loss: 370.9996 | PINN loss: 370.2895 | Contrastive loss: 4.7342 | PDE loss: 0.0016 | Physics loss: 0.8155
[Epoch 58] Total loss: 318.6031 | PINN loss: 317.8926 | Contrastive loss: 4.7365 | PDE loss: 0.0016 | Physics loss: 0.8029
[Epoch 59] Total loss: 271.3850 | PINN loss: 270.6748 | Contrastive loss: 4.7348 | PDE loss: 0.0016 | Physics loss: 0.8133
[Epoch 60] Total loss: 230.2408 | PINN loss: 229.5299 | Contrastive loss: 4.7394 | PDE loss: 0.0016 | Physics loss: 0.8171
[Validation] Epoch 60: MSE = 210.573547
New best model saved at epoch 60 with validation MSE: 210.573547
[Test] MSE: 170.12338257, MAE: 11.006870, MAPE: 0.156466, RMSE: 13.043136, R²: -2.4604
[Epoch 61] Total loss: 193.1928 | PINN loss: 192.4825 | Contrastive loss: 4.7356 | PDE loss: 0.0016 | Physics loss: 0.7998
[Epoch 62] Total loss: 162.4309 | PINN loss: 161.7220 | Contrastive loss: 4.7258 | PDE loss: 0.0016 | Physics loss: 0.5971
[Epoch 63] Total loss: 135.8569 | PINN loss: 135.1483 | Contrastive loss: 4.7239 | PDE loss: 0.0016 | Physics loss: 0.3193
[Epoch 64] Total loss: 112.8083 | PINN loss: 112.1007 | Contrastive loss: 4.7170 | PDE loss: 0.0019 | Physics loss: 0.1570
[Epoch 65] Total loss: 92.3216 | PINN loss: 91.6151 | Contrastive loss: 4.7101 | PDE loss: 0.0024 | Physics loss: 0.1600
[Epoch 66] Total loss: 75.2632 | PINN loss: 74.5580 | Contrastive loss: 4.7011 | PDE loss: 0.0021 | Physics loss: 0.1318
[Epoch 67] Total loss: 61.3250 | PINN loss: 60.6202 | Contrastive loss: 4.6991 | PDE loss: 0.0019 | Physics loss: 0.1079
[Epoch 68] Total loss: 49.4065 | PINN loss: 48.7021 | Contrastive loss: 4.6960 | PDE loss: 0.0019 | Physics loss: 0.0994
[Epoch 69] Total loss: 39.7685 | PINN loss: 39.0641 | Contrastive loss: 4.6963 | PDE loss: 0.0018 | Physics loss: 0.0949
[Epoch 70] Total loss: 31.6932 | PINN loss: 30.9887 | Contrastive loss: 4.6965 | PDE loss: 0.0018 | Physics loss: 0.0786
[Validation] Epoch 70: MSE = 27.564211
New best model saved at epoch 70 with validation MSE: 27.564211
[Test] MSE: 13.21736145, MAE: 2.275202, MAPE: 0.027525, RMSE: 3.635569, R²: 0.7311
[Epoch 71] Total loss: 25.2216 | PINN loss: 24.5172 | Contrastive loss: 4.6964 | PDE loss: 0.0018 | Physics loss: 0.0724
[Epoch 72] Total loss: 20.0991 | PINN loss: 19.3954 | Contrastive loss: 4.6914 | PDE loss: 0.0018 | Physics loss: 0.0682
[Epoch 73] Total loss: 15.9708 | PINN loss: 15.2667 | Contrastive loss: 4.6940 | PDE loss: 0.0017 | Physics loss: 0.0609
[Epoch 74] Total loss: 12.7697 | PINN loss: 12.0659 | Contrastive loss: 4.6917 | PDE loss: 0.0017 | Physics loss: 0.0577
[Epoch 75] Total loss: 10.2820 | PINN loss: 9.5778 | Contrastive loss: 4.6948 | PDE loss: 0.0017 | Physics loss: 0.0514
[Epoch 76] Total loss: 8.3794 | PINN loss: 7.6756 | Contrastive loss: 4.6935 | PDE loss: 0.0017 | Physics loss: 0.0488
[Epoch 77] Total loss: 6.9914 | PINN loss: 6.2935 | Contrastive loss: 4.6917 | PDE loss: 0.0017 | Physics loss: 0.0468
[Epoch 78] Total loss: 5.8195 | PINN loss: 5.1463 | Contrastive loss: 4.6861 | PDE loss: 0.0017 | Physics loss: 0.0407
[Epoch 79] Total loss: 4.9068 | PINN loss: 4.2914 | Contrastive loss: 4.6868 | PDE loss: 0.0017 | Physics loss: 0.0379
[Epoch 80] Total loss: 4.2191 | PINN loss: 3.6759 | Contrastive loss: 4.6838 | PDE loss: 0.0017 | Physics loss: 0.0339
[Validation] Epoch 80: MSE = 2.741551
New best model saved at epoch 80 with validation MSE: 2.741551
[Test] MSE: 0.28321251, MAE: 0.384530, MAPE: 0.004625, RMSE: 0.532177, R²: 0.9942
[Epoch 81] Total loss: 3.6628 | PINN loss: 3.1866 | Contrastive loss: 4.6855 | PDE loss: 0.0017 | Physics loss: 0.0333
[Epoch 82] Total loss: 3.2310 | PINN loss: 2.8098 | Contrastive loss: 4.6816 | PDE loss: 0.0017 | Physics loss: 0.0282
[Epoch 83] Total loss: 2.8817 | PINN loss: 2.5058 | Contrastive loss: 4.6818 | PDE loss: 0.0017 | Physics loss: 0.0248
[Epoch 84] Total loss: 2.5899 | PINN loss: 2.2522 | Contrastive loss: 4.6766 | PDE loss: 0.0017 | Physics loss: 0.0234
[Epoch 85] Total loss: 2.3346 | PINN loss: 2.0301 | Contrastive loss: 4.6769 | PDE loss: 0.0017 | Physics loss: 0.0213
[Epoch 86] Total loss: 2.1585 | PINN loss: 1.8770 | Contrastive loss: 4.6760 | PDE loss: 0.0017 | Physics loss: 0.0208
[Epoch 87] Total loss: 2.0178 | PINN loss: 1.7546 | Contrastive loss: 4.6771 | PDE loss: 0.0017 | Physics loss: 0.0196
[Epoch 88] Total loss: 1.8571 | PINN loss: 1.6148 | Contrastive loss: 4.6730 | PDE loss: 0.0017 | Physics loss: 0.0176
[Epoch 89] Total loss: 1.7418 | PINN loss: 1.5146 | Contrastive loss: 4.6762 | PDE loss: 0.0016 | Physics loss: 0.0175
[Epoch 90] Total loss: 1.6435 | PINN loss: 1.4291 | Contrastive loss: 4.6722 | PDE loss: 0.0016 | Physics loss: 0.0160
[Validation] Epoch 90: MSE = 0.809768
New best model saved at epoch 90 with validation MSE: 0.809768
[Test] MSE: 0.05242228, MAE: 0.194506, MAPE: 0.002443, RMSE: 0.228959, R²: 0.9989
[Epoch 91] Total loss: 1.5743 | PINN loss: 1.3690 | Contrastive loss: 4.6727 | PDE loss: 0.0016 | Physics loss: 0.0165
[Epoch 92] Total loss: 1.5163 | PINN loss: 1.3186 | Contrastive loss: 4.6724 | PDE loss: 0.0016 | Physics loss: 0.0171
[Epoch 93] Total loss: 1.4657 | PINN loss: 1.2745 | Contrastive loss: 4.6741 | PDE loss: 0.0016 | Physics loss: 0.0163
[Epoch 94] Total loss: 1.4289 | PINN loss: 1.2425 | Contrastive loss: 4.6717 | PDE loss: 0.0016 | Physics loss: 0.0160
[Epoch 95] Total loss: 1.3785 | PINN loss: 1.1987 | Contrastive loss: 4.6703 | PDE loss: 0.0016 | Physics loss: 0.0154
[Epoch 96] Total loss: 1.3590 | PINN loss: 1.1817 | Contrastive loss: 4.6732 | PDE loss: 0.0016 | Physics loss: 0.0151
[Epoch 97] Total loss: 1.3354 | PINN loss: 1.1612 | Contrastive loss: 4.6701 | PDE loss: 0.0016 | Physics loss: 0.0158
[Epoch 98] Total loss: 1.3105 | PINN loss: 1.1395 | Contrastive loss: 4.6717 | PDE loss: 0.0016 | Physics loss: 0.0160
[Epoch 99] Total loss: 1.3032 | PINN loss: 1.1332 | Contrastive loss: 4.6727 | PDE loss: 0.0016 | Physics loss: 0.0156
[Epoch 100] Total loss: 1.2767 | PINN loss: 1.1102 | Contrastive loss: 4.6711 | PDE loss: 0.0016 | Physics loss: 0.0155
[Validation] Epoch 100: MSE = 0.520030
New best model saved at epoch 100 with validation MSE: 0.520030
[Test] MSE: 0.04357005, MAE: 0.176319, MAPE: 0.002169, RMSE: 0.208734, R²: 0.9991
/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/numpy/lib/function_base.py:2559: RuntimeWarning: invalid value encountered in true_divide
  c /= stddev[:, None]
/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/numpy/lib/function_base.py:2560: RuntimeWarning: invalid value encountered in true_divide
  c /= stddev[None, :]
Could not load best model for final visualization: name 'stats' is not defined
Training completed. Best model at epoch 100 with validation MSE: 0.520030
