Original dataset loaded: 683 training batches
Augmented dataset loaded: 2065 training batches
Initializing PINN model...
2025-07-04 11:50 - function:_save_args - INFO - Args:
2025-07-04 11:50 - function:_save_args - CRITICAL - 	csv_file:/home/choi/PICL/data_processed/preprocessed_battery_health_dataset_all_points.csv
2025-07-04 11:50 - function:_save_args - CRITICAL - 	csv_file_augmented:/home/choi/PICL/data_augmentation/battery_phys_augmented.csv
2025-07-04 11:50 - function:_save_args - CRITICAL - 	batch_size:128
2025-07-04 11:50 - function:_save_args - CRITICAL - 	normalization_method:z-score
2025-07-04 11:50 - function:_save_args - CRITICAL - 	epochs:50
2025-07-04 11:50 - function:_save_args - CRITICAL - 	early_stop:30
2025-07-04 11:50 - function:_save_args - CRITICAL - 	lr:0.001
2025-07-04 11:50 - function:_save_args - CRITICAL - 	lr_F:0.0005
2025-07-04 11:50 - function:_save_args - CRITICAL - 	save_folder:result_small_sample_05_06_07_18
2025-07-04 11:50 - function:_save_args - CRITICAL - 	alpha:1.0
2025-07-04 11:50 - function:_save_args - CRITICAL - 	beta:1.0
2025-07-04 11:50 - function:_save_args - CRITICAL - 	contrastive_weight:1.0
2025-07-04 11:50 - function:_save_args - CRITICAL - 	pinn_weight:1.0
2025-07-04 11:50 - function:_save_args - CRITICAL - 	temperature:0.005
2025-07-04 11:50 - function:_save_args - CRITICAL - 	log_dir:training_log.txt
2025-07-04 11:50 - function:_save_args - CRITICAL - 	F_layers_num:4
2025-07-04 11:50 - function:_save_args - CRITICAL - 	F_hidden_dim:128
2025-07-04 11:50 - function:_save_args - CRITICAL - 	warmup_lr:0.0001
2025-07-04 11:50 - function:_save_args - CRITICAL - 	final_lr:1e-05
2025-07-04 11:50 - function:_save_args - CRITICAL - 	warmup_epochs:50
2025-07-04 11:50 - function:_save_args - CRITICAL - 	momentum:0.999
2025-07-04 11:50 - function:_save_args - CRITICAL - 	projection_dim:128
2025-07-04 11:50 - function:_save_args - CRITICAL - 	queue_size:4096
2025-07-04 11:50 - function:_save_args - CRITICAL - 	seed:42
2025-07-04 11:50 - function:_save_args - CRITICAL - 	wandb_project:battery-picle-small-dataset
2025-07-04 11:50 - function:_save_args - CRITICAL - 	wandb_entity:None
2025-07-04 11:50 - function:_save_args - CRITICAL - 	wandb_run_name:None
Could not create model visualization for wandb
Setting up contrastive learning ...
Starting training...
[Epoch 1] Total loss: 6081.1854 | PINN loss: 6071.9362 | Contrastive loss: 30.8308 | PDE loss: 0.0242 | Physics loss: 1.4319
[Validation] Epoch 1: MSE = 5663.220215
New best model saved at epoch 1 with validation MSE: 5663.220215
[Test] MSE: 5484.52929688, MAE: 73.724785, MAPE: 9.678291, RMSE: 74.057610, R²: -110.5595
[Epoch 2] Total loss: 5427.4796 | PINN loss: 5420.2175 | Contrastive loss: 24.2071 | PDE loss: 0.0050 | Physics loss: 1.1279
[Epoch 3] Total loss: nan | PINN loss: 4923.4708 | Contrastive loss: inf | PDE loss: 0.0035 | Physics loss: 1.1640
[Epoch 4] Total loss: nan | PINN loss: 4146.9877 | Contrastive loss: nan | PDE loss: 0.0046 | Physics loss: 1.1443
[Epoch 5] Total loss: nan | PINN loss: 3599.0505 | Contrastive loss: nan | PDE loss: 0.0023 | Physics loss: 1.0778
[Epoch 6] Total loss: nan | PINN loss: 3244.5769 | Contrastive loss: nan | PDE loss: 0.0021 | Physics loss: 1.0335
[Epoch 7] Total loss: nan | PINN loss: 2971.9266 | Contrastive loss: nan | PDE loss: 0.0020 | Physics loss: 0.9895
[Epoch 8] Total loss: nan | PINN loss: 2751.2572 | Contrastive loss: nan | PDE loss: 0.0019 | Physics loss: 0.9583
[Epoch 9] Total loss: nan | PINN loss: 2578.9921 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.9190
[Epoch 10] Total loss: nan | PINN loss: 2446.7875 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.9154
[Validation] Epoch 10: MSE = 2386.988525
New best model saved at epoch 10 with validation MSE: 2386.988525
[Test] MSE: 2267.08544922, MAE: 47.094597, MAPE: 1.375009, RMSE: 47.613922, R²: -45.1143
[Epoch 11] Total loss: nan | PINN loss: 2348.1726 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.8995
[Epoch 12] Total loss: nan | PINN loss: 2281.2886 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.8885
[Epoch 13] Total loss: nan | PINN loss: 2238.3048 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.8786
[Epoch 14] Total loss: nan | PINN loss: 2214.3828 | Contrastive loss: nan | PDE loss: 0.0016 | Physics loss: 0.8798
[Epoch 15] Total loss: nan | PINN loss: 2203.0035 | Contrastive loss: nan | PDE loss: 0.0016 | Physics loss: 0.8852
[Epoch 16] Total loss: nan | PINN loss: 2048.6925 | Contrastive loss: nan | PDE loss: 0.0024 | Physics loss: 0.8583
[Epoch 17] Total loss: nan | PINN loss: 1767.0017 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.8342
[Epoch 18] Total loss: nan | PINN loss: 1515.9411 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.8149
[Epoch 19] Total loss: nan | PINN loss: 1289.0174 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.8015
[Epoch 20] Total loss: nan | PINN loss: 1090.0491 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.8122
[Validation] Epoch 20: MSE = 998.793091
New best model saved at epoch 20 with validation MSE: 998.793091
[Test] MSE: 917.68963623, MAE: 29.470402, MAPE: 0.568109, RMSE: 30.293392, R²: -17.6665
[Epoch 21] Total loss: nan | PINN loss: 913.9577 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.8007
[Epoch 22] Total loss: nan | PINN loss: 759.2417 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.7982
[Epoch 23] Total loss: nan | PINN loss: 627.5660 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.8090
[Epoch 24] Total loss: nan | PINN loss: 514.5940 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.8053
[Epoch 25] Total loss: nan | PINN loss: 420.3141 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.7940
[Epoch 26] Total loss: nan | PINN loss: 341.5722 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.7992
[Epoch 27] Total loss: nan | PINN loss: 278.2819 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.8053
[Epoch 28] Total loss: nan | PINN loss: 225.5129 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.8141
[Epoch 29] Total loss: nan | PINN loss: 184.6957 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.7820
[Epoch 30] Total loss: nan | PINN loss: 152.1094 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.4738
[Validation] Epoch 30: MSE = 139.040176
New best model saved at epoch 30 with validation MSE: 139.040176
[Test] MSE: 105.79174805, MAE: 8.252805, MAPE: 0.111945, RMSE: 10.285512, R²: -1.1519
[Epoch 31] Total loss: nan | PINN loss: 125.9546 | Contrastive loss: nan | PDE loss: 0.0021 | Physics loss: 0.2852
[Epoch 32] Total loss: nan | PINN loss: 105.4327 | Contrastive loss: nan | PDE loss: 0.0020 | Physics loss: 0.2266
[Epoch 33] Total loss: nan | PINN loss: 89.5822 | Contrastive loss: nan | PDE loss: 0.0020 | Physics loss: 0.1812
[Epoch 34] Total loss: nan | PINN loss: 76.1110 | Contrastive loss: nan | PDE loss: 0.0019 | Physics loss: 0.1385
[Epoch 35] Total loss: nan | PINN loss: 65.6336 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.1149
[Epoch 36] Total loss: nan | PINN loss: 57.7074 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.1143
[Epoch 37] Total loss: nan | PINN loss: 51.0606 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.1120
[Epoch 38] Total loss: nan | PINN loss: 46.0002 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.1097
[Epoch 39] Total loss: nan | PINN loss: 42.3832 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.1065
[Epoch 40] Total loss: nan | PINN loss: 39.4599 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.1022
[Validation] Epoch 40: MSE = 38.495277
New best model saved at epoch 40 with validation MSE: 38.495277
[Test] MSE: 20.74703979, MAE: 2.951628, MAPE: 0.036211, RMSE: 4.554892, R²: 0.5780
[Epoch 41] Total loss: nan | PINN loss: 37.4845 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.1001
[Epoch 42] Total loss: nan | PINN loss: 36.1953 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.0947
[Epoch 43] Total loss: nan | PINN loss: 35.2746 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.1003
[Epoch 44] Total loss: nan | PINN loss: 34.6844 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.0978
[Epoch 45] Total loss: nan | PINN loss: 34.5685 | Contrastive loss: nan | PDE loss: 0.0017 | Physics loss: 0.0967
[Epoch 46] Total loss: nan | PINN loss: 25.4784 | Contrastive loss: nan | PDE loss: 0.0029 | Physics loss: 0.0860
[Epoch 47] Total loss: nan | PINN loss: 14.0683 | Contrastive loss: nan | PDE loss: 0.0019 | Physics loss: 0.0682
[Epoch 48] Total loss: nan | PINN loss: 8.2897 | Contrastive loss: nan | PDE loss: 0.0019 | Physics loss: 0.0528
[Epoch 49] Total loss: nan | PINN loss: 5.1787 | Contrastive loss: nan | PDE loss: 0.0019 | Physics loss: 0.0405
[Epoch 50] Total loss: nan | PINN loss: 3.4197 | Contrastive loss: nan | PDE loss: 0.0018 | Physics loss: 0.0289
[Validation] Epoch 50: MSE = 2.261263
New best model saved at epoch 50 with validation MSE: 2.261263
[Test] MSE: 0.26255128, MAE: 0.397103, MAPE: 0.004956, RMSE: 0.512398, R²: 0.9947
/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/numpy/lib/function_base.py:2559: RuntimeWarning: invalid value encountered in true_divide
  c /= stddev[:, None]
/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/numpy/lib/function_base.py:2560: RuntimeWarning: invalid value encountered in true_divide
  c /= stddev[None, :]
Could not load best model for final visualization: name 'stats' is not defined
Training completed. Best model at epoch 50 with validation MSE: 2.261263
