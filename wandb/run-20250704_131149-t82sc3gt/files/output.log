Original dataset loaded: 683 training batches
Augmented dataset loaded: 2065 training batches
Initializing PINN model...
2025-07-04 13:11 - function:_save_args - INFO - Args:
2025-07-04 13:11 - function:_save_args - CRITICAL - 	csv_file:/home/choi/PICL/data_processed/preprocessed_battery_health_dataset_all_points.csv
2025-07-04 13:11 - function:_save_args - CRITICAL - 	csv_file_augmented:/home/choi/PICL/data_augmentation/battery_phys_augmented.csv
2025-07-04 13:11 - function:_save_args - CRITICAL - 	batch_size:128
2025-07-04 13:11 - function:_save_args - CRITICAL - 	normalization_method:z-score
2025-07-04 13:11 - function:_save_args - CRITICAL - 	epochs:100
2025-07-04 13:11 - function:_save_args - CRITICAL - 	early_stop:30
2025-07-04 13:11 - function:_save_args - CRITICAL - 	lr:0.001
2025-07-04 13:11 - function:_save_args - CRITICAL - 	lr_F:0.0005
2025-07-04 13:11 - function:_save_args - CRITICAL - 	save_folder:result_small_sample_05_06_07_18
2025-07-04 13:11 - function:_save_args - CRITICAL - 	alpha:0.7
2025-07-04 13:11 - function:_save_args - CRITICAL - 	beta:0.7
2025-07-04 13:11 - function:_save_args - CRITICAL - 	contrastive_weight:0.8
2025-07-04 13:11 - function:_save_args - CRITICAL - 	pinn_weight:1.0
2025-07-04 13:11 - function:_save_args - CRITICAL - 	temperature:0.005
2025-07-04 13:11 - function:_save_args - CRITICAL - 	log_dir:training_log.txt
2025-07-04 13:11 - function:_save_args - CRITICAL - 	F_layers_num:4
2025-07-04 13:11 - function:_save_args - CRITICAL - 	F_hidden_dim:128
2025-07-04 13:11 - function:_save_args - CRITICAL - 	warmup_lr:0.0001
2025-07-04 13:11 - function:_save_args - CRITICAL - 	final_lr:1e-05
2025-07-04 13:11 - function:_save_args - CRITICAL - 	warmup_epochs:50
2025-07-04 13:11 - function:_save_args - CRITICAL - 	momentum:0.999
2025-07-04 13:11 - function:_save_args - CRITICAL - 	projection_dim:128
2025-07-04 13:11 - function:_save_args - CRITICAL - 	queue_size:4096
2025-07-04 13:11 - function:_save_args - CRITICAL - 	seed:42
2025-07-04 13:11 - function:_save_args - CRITICAL - 	wandb_project:battery-picle-small-dataset
2025-07-04 13:11 - function:_save_args - CRITICAL - 	wandb_entity:None
2025-07-04 13:11 - function:_save_args - CRITICAL - 	wandb_run_name:None
Could not create model visualization for wandb
Setting up contrastive learning ...
Starting training...
[Epoch 1] Total loss: 6078.5161 | PINN loss: 6071.1167 | Contrastive loss: 30.8308 | PDE loss: 0.0243 | Physics loss: 1.4698
[Validation] Epoch 1: MSE = 5662.895020
New best model saved at epoch 1 with validation MSE: 5662.895020
[Test] MSE: 5484.20458984, MAE: 73.722588, MAPE: 9.675204, RMSE: 74.055412, RÂ²: -110.5529
[Epoch 2] Total loss: 5425.3461 | PINN loss: 5419.5637 | Contrastive loss: 24.0932 | PDE loss: 0.0050 | Physics loss: 1.1293
[Epoch 3] Total loss: 4926.8865 | PINN loss: 4922.6872 | Contrastive loss: 17.4968 | PDE loss: 0.0035 | Physics loss: 1.1625
[Epoch 4] Total loss: nan | PINN loss: 4152.1877 | Contrastive loss: nan | PDE loss: 0.0048 | Physics loss: 1.1606
[Epoch 5] Total loss: nan | PINN loss: 3599.3466 | Contrastive loss: nan | PDE loss: 0.0024 | Physics loss: 1.0943
Traceback (most recent call last):
  File "main.py", line 857, in <module>
    main()
  File "main.py", line 851, in main
    train_contrastive_pinn(wrapper, orig_loader, aug_loader, args)
  File "main.py", line 191, in train_contrastive_pinn
    total_loss, pinn_loss, contrastive_loss, pde_loss, physics_loss = wrapper(x1, x2, y1, y2)
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/choi/PICL/contrastive_Learning/contrastive.py", line 304, in forward
    u1, f1 = self.pinn(x1)
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/choi/PICL/Model/Model.py", line 574, in forward
    u = self.solution_u(xt, t)
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/choi/PICL/Model/Model.py", line 118, in forward
    encoded = self.encoder(x)
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/choi/PICL/Model/Model.py", line 77, in forward
    time_embedding = self.time_net(time)
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/nn/modules/container.py", line 117, in forward
    input = module(input)
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 93, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/choi/anaconda3/envs/picl/lib/python3.7/site-packages/torch/nn/functional.py", line 1690, in linear
    ret = torch.addmm(bias, input, weight.t())
KeyboardInterrupt
